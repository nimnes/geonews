<% provide(:title, 'Лемматизатор') %>
<h1>Лемматизатор</h1>
<%= form_tag do %>
    <textarea name="input_text" class="span12" id="input-textarea" rows="8" placeholder="Введите текст..."><%= @input_text %></textarea>
    <button type="submit" class="btn">Привести к нормальной форме</button>
<% end %>

<% if @entities.any? %>
    <table class="table table-striped table-bordered table-condensed">
      <thead>
      <tr>
        <th>№</th>
        <th>Место</th>
        <th>Люди</th>
        <th>Время</th>
      </tr>
      </thead>
      <% @entities.each_with_index do |entity, index| %>
          <% unless entity.locations.empty? && entity.persons.empty? %>
              <tr>
                <td><%= index %></td>
                <% persons = "" %>
                <% locations = "" %>
                <% entity.locations.each do |location| %>
                    <% locations += location[:name] + " [#{location[:coords]}]" + ", " %>
                <% end %>

                <% if entity.locations.count > 0 %>
                    <% locations = locations[0...-2] %>
                <% end %>
                <td><%= locations %></td>

                <% entity.persons.each do |p| %>
                    <% persons += p.surname + ", " %>
                <% end %>

                <% if entity.persons.count > 0 %>
                    <% persons = persons[0...-2] %>
                <% end %>

                <td><%= persons %></td>
                <td><%= entity.time %></td>
              </tr>
          <% end %>
      <% end %>
    </table>
<% end %>
